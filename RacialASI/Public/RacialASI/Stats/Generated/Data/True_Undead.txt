// True Undead by actualsailorcat , Thanks !

new entry "Fenrules_Undeath"
type "PassiveData"
data "DisplayName" "7342900a-1e03-4609-a77e-92b5089efabe;1"
data "Description" "h2a86252bg933bg45dega12cg276554b99997;1"
data "Boosts" "Ability(Constitution, 1); Resistance(Poison, Immune); StatusImmunity(SG_Poisoned); StatusImmunity(SG_Disease); Advantage(DeathSavingThrow,); Tag(UNDEAD); UnlockInterrupt(Fenrules_NECROTIC_REDUCTION_Interrupt)"
data "Icon" "PassiveFeature_InuredTo-Undeath"
data "Properties" "Highlighted"
data "StatsFunctorContext" "OnCreate;OnLongRest"
data "Conditions" "not HasStatus('Fenrules_NECROTIC_REDUCTION', context.Source)"
data "StatsFunctors" "ApplyStatus(Fenrules_NECROTIC_REDUCTION,100,-1)"
// Last 3 lines from kashai for negative energy interaction.

new entry "Fenrules_UndyingFervor"
type "PassiveData"
data "DisplayName" "8044db69-d33f-4f59-8bbf-791ad0bd2f28;1"
data "Description" "a63dce7f-a907-4a57-88de-dd05fa525363;1"
data "DescriptionParams" "RegainHitPoints(1d12)"
data "Icon" "PassiveFeature_Generic_Death"
data "Properties" "Highlighted"
data "StatsFunctorContext" "OnCreate;OnLongRest"
data "StatsFunctors" "ApplyStatus(SELF,Fenrules_UNDYING_FERVOR,100,-1)"

new entry "Fenrules_UNDYING_FERVOR"
type "StatusData"
data "StatusType" "BOOST"
using "SURVIVAL_INSTINCT"
data "DisplayName" "8044db69-d33f-4f59-8bbf-791ad0bd2f28;1"
data "Description" "a63dce7f-a907-4a57-88de-dd05fa525363;1"
data "DescriptionParams" "RegainHitPoints(1d12)"
data "Icon" "PassiveFeature_Generic_Death"
data "SoundLoop" ""
data "SoundStop" ""
data "StackId" "Fenrules_UNDYING_FERVOR"
data "Boosts" "DownedStatus(Fenrules_UNDYING_FERVOR_DOWNED,5)"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;ApplyToDead;IgnoreResting"
data "StatusGroups" "SG_RemoveOnRespec"
data "StatusEffect" ""

new entry "Fenrules_UNDYING_FERVOR_DOWNED"
type "StatusData"
data "StatusType" "DOWNED"
using "SURVIVAL_INSTINCT_DOWNED"
data "DisplayName" "8044db69-d33f-4f59-8bbf-791ad0bd2f28;1"
data "Icon" "PassiveFeature_RelentlessEndurance"
data "OnApplyFunctors" "RemoveStatus(Fenrules_UNDYING_FERVOR);RegainHitPoints(1d12,Guaranteed)"
data "StatusGroups" "SG_Incapacitated"
data "ApplyEffect" ""

//Necrotic energy heal and reduction by kashai
new entry "Fenrules_NECROTIC_REGENERATION_TECHNICAL"
type "PassiveData"
data "DisplayName" "ba8b4d89-90de-4d95-9a22-7f60d5028f8f;1"
data "StatsFunctorContext" "OnDamaged"
data "Properties" "IsHidden"
data "Conditions" "IsDamageTypeNecrotic()"
data "StatsFunctors" "RegainHitPoints(1d6+ConstitutionModifier+1)"

new entry "Fenrules_NECROTIC_REGENERATION"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "ba8b4d89-90de-4d95-9a22-7f60d5028f8f;1"
data "Description" "8bd48253-bd15-4019-ac8e-f186b76d9389;1"
data "StatusPropertyFlags" "DisablePortraitIndicator;DisableOverhead;DisableCombatlog;ApplyToDead;IgnoreResting"
data "Icon" "GenericIcon_DamageType_Necrotic"
data "StackID" "Fenrules_NECROTIC_REGENERATION"
data "OnApplyFunctors" "RegainHitPoints(1d6+ConstitutionModifier)"

new entry "Fenrules_NECROTIC_REDUCTION"
type "StatusData"
data "StatusType" "BOOST"
data "DisplayName" "ba8b4d89-90de-4d95-9a22-7f60d5028f8f;1"
data "Description" "8bd48253-bd15-4019-ac8e-f186b76d9389;1"
data "StatusPropertyFlags" "DisablePortraitIndicator;DisableOverhead;DisableCombatlog;ApplyToDead;IgnoreResting"
data "Icon" "GenericIcon_DamageType_Necrotic"
data "OnApplyConditions" ""
data "StackID" "Fenrules_NECROTIC_REDUCTION"
data "StackType" ""
data "Boosts" "DamageReduction(Necrotic,Threshold,1000)"
data "StatusGroups" "SG_RemoveOnRespec"
data "Passives" "Fenrules_NECROTIC_REGENERATION_TECHNICAL"

new entry "Fenrules_NECROTIC_REDUCTION_Interrupt"
type "InterruptData"
data "DisplayName" "ba8b4d89-90de-4d95-9a22-7f60d5028f8f;1"
data "Description" "8bd48253-bd15-4019-ac8e-f186b76d9389;1"
data "ExtraDescription" ""
data "Icon" "GenericIcon_DamageType_Necrotic"
data "InterruptContext" "OnPreDamage"
data "InterruptContextScope" "Self"
data "Container" "YesNoDecision"
data "Conditions" "Self(context.Target,context.Observer) and SpellDamageTypeIs(DamageType.Necrotic)"
data "Properties" "AdjustRoll(OBSERVER_OBSERVER,-1000,Necrotic);IF(not IsCantrip() and not(IsSpellChildOrVariantFromContext('Target_ChillTouch'))):ApplyStatus(Fenrules_NECROTIC_REGENERATION,100,0)"
data "Cost" ""
data "InterruptDefaultValue" "Ask;Enabled"
data "EnableCondition" "HasPassive("Sailor_Undeath", context.Source) and not HasStatus('SG_Polymorph') or Tagged('MINDFLAYER')"
data "EnableContext" "OnStatusApplied"

// Potions of Healing patch for undead Tag

new entry "POTION_OF_HEALING"
type "StatusData"
data "StatusType" "BOOST"
// Potion of Healing
data "DisplayName" "h3374a21dg852ag47a0gb5c9g93ecfec8cf01;1"
data "Icon" "Item_CONS_Potion_Healing_A"
data "HitAnimationType" "MagicalNonDamage"
data "StackId" "POTION_OF_HEALING"
data "StatusPropertyFlags" "DisableOverhead;DisableCombatlog;DisablePortraitIndicator"
data "OnApplyFunctors" "IF(not Tagged('UNDEAD')):RegainHitPoints(2d4+2);IF(not Tagged('UNDEAD')):RemoveStatus(BURNING);IF(Tagged('UNDEAD')):RegainHitPoints(0)"
data "ApplyEffect" "89f2d0ac-9295-4657-bfa6-fb6d61adf59c"

new entry "POTION_OF_HEALING_SUPERIOR"
type "StatusData"
data "StatusType" "BOOST"
using "POTION_OF_HEALING"
// Potion of Superior Healing
data "DisplayName" "h34febb84gd18dg4207ga6abg2a48fc7c471c;1"
data "StackId" "POTION_OF_SUPERIOR_HEALING"
data "OnApplyFunctors" "IF(not Tagged('UNDEAD')):RegainHitPoints(8d4+8);IF(not Tagged('UNDEAD')):RemoveStatus(BURNING);IF(Tagged('UNDEAD')):RegainHitPoints(0)"
data "ApplyEffect" "4a25f012-eb01-41ba-b2e5-64a31e67f82c"

new entry "POTION_OF_HEALING_SUPREME"
type "StatusData"
data "StatusType" "BOOST"
using "POTION_OF_HEALING"
// Potion of Supreme Healing
data "DisplayName" "h0c9c61ecgfc1fg44f2g9274gfa4fbb2e16e8;1"
data "StackId" "POTION_OF_SUPREME_HEALING"
data "OnApplyFunctors" "IF(not Tagged('UNDEAD')):RegainHitPoints(10d4+20);IF(not Tagged('UNDEAD')):RemoveStatus(BURNING);IF(Tagged('UNDEAD')):RegainHitPoints(0)"
data "ApplyEffect" "bd3c1d13-92f4-40dc-91a0-a8450ec2be75"

new entry "POTION_OF_HEALING_GREATER"
type "StatusData"
data "StatusType" "BOOST"
using "POTION_OF_HEALING"
// Potion of Greater Healing
data "DisplayName" "hbb8c0a45g3cd2g4d90gae52g1a49450acd7d;1"
data "Icon" "Item_CONS_Potion_Healing_A_Greater"
data "StackId" "POTION_OF_GREATER_HEALING"
data "OnApplyFunctors" "IF(not Tagged('UNDEAD')):RegainHitPoints(4d4+4);IF(not Tagged('UNDEAD')):RemoveStatus(BURNING);IF(Tagged('UNDEAD')):RegainHitPoints(0)"
data "ApplyEffect" "e99043b5-8d1c-47da-a8bb-87017454b330"